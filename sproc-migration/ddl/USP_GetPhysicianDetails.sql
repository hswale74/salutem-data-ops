 Create procedure [dbo].USP_GetPhysicianDetails ( 	@PhysicianId INT, 	@search nvarchar(50) = '',  	@orderBy nvarchar(50) = 'ID',  	@orderDir varchar(4) = 'asc',  	@pageIndex int = 0,  	@pageSize int = 99999 ) AS BEGIN 	SET NOCOUNT ON;  	WITH Result AS ( 		SELECT  			P.ID, 			P.PhysicianName, 			P.Phone, 			P.Email, 			P.IsDeleted, 			P.CreatedBy, 			U.User_First_Name + ' '+ U.User_Last_Name AS CreatedByName,  			P.UpdatedBy, 			Up.User_First_Name + ' '+ Up.User_Last_Name AS UpdatedByName 		FROM dbo.Mst_Physician P with (nolock) 		LEFT JOIN Mst_User U ON P.CreatedBy = U.User_ID  		LEFT JOIN Mst_User Up ON P.UpdatedBy = Up.User_ID 		WHERE (@PhysicianId = 0 OR P.ID = @PhysicianId)  			AND (P.PhysicianName  LIKE '%' + @search + '%' OR P.Phone LIKE '%' + @search + '%') 			AND (@pageSize <= 100 OR P.IsDeleted = 0) 	),  	OrderByResult AS (SELECT *, 			ROW_NUMBER() over ( 			order BY case when @orderBy = 'PhysicianName' and @orderDir = 'asc' then PhysicianName end, 								case when @orderBy = 'PhysicianName' and @orderDir = 'desc' then PhysicianName end desc, 								case when @orderBy = 'ID' and @orderDir = 'asc' then ID end, 								case when @orderBy = 'ID' and @orderDir = 'desc' then ID end desc, 								case when @orderBy = 'Phone' and @orderDir = 'asc' then Phone end, 								case when @orderBy = 'Phone' and @orderDir = 'desc' then Phone end desc, 								case when @orderBy = 'Email' and @orderDir = 'asc' then Email end, 								case when @orderBy = 'Email' and @orderDir = 'desc' then Email end desc, 								 								case when @orderBy = 'CreatedByName' and @orderDir = 'asc' then CreatedByName end, 								case when @orderBy = 'CreatedByName' and @orderDir = 'desc' then CreatedByName end desc, 								case when @orderBy = 'UpdatedByName' and @orderDir = 'asc' then UpdatedByName end, 								case when @orderBy = 'UpdatedByName' and @orderDir = 'desc' then UpdatedByName end desc 								 			) AS RowNumber FROM Result  	)   	SELECT *, (Select Count(ID) FROM Result) TotalRows   	FROM OrderByResult  	WHERE --OrderByResult.RowNumber BETWEEN ((@pageIndex * @pageSize) + 1) AND ((@pageIndex + 1) * @pageSize) 		OrderByResult.RowNumber BETWEEN (@pageIndex + 1) AND (@pageIndex  + @pageSize)  END  --EXEC USP_GetPhysicianDetails 0,''