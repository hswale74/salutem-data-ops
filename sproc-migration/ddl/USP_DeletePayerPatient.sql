 Create procedure USP_DeletePayerPatient  AS BEGIN 	CREATE TABLE #TempPatient ( 	 PatientID INT 	) 	 	CREATE TABLE #TempActivity ( 	 PatientActivityID INT 	) 	 	INSERT INTO #TempPatient SELECT P.Patient_ID FROM Mst_Patient P INNER JOIN Salutem_Temp.dbo.MemberMRN M ON P.Patient_MRN = M.MRN; 	INSERT INTO  #TempActivity SELECT Patient_Activity_ID FROM Trn_Patient_Activity A INNER JOIN #TempPatient T ON A.Patient_ID = T.PatientID 	 	DELETE U FROM Trn_Patient_UHCDetails U INNER JOIN #TempPatient T ON U.PatientID=T.PatientID 	DELETE C FROM Trn_Patient_Contact C INNER JOIN #TempPatient T ON C.Patient_ID = T.PatientID 	 	DELETE AR FROM Trn_ActivityAssessmentResponse AR INNER JOIN #TempActivity TA ON AR.PatientActivityId = TA.PatientActivityID 	DELETE AA FROM Trn_Activity_Assignment AA INNER JOIN #TempActivity TA ON AA.Patient_Activity_ID = TA.PatientActivityID 	DELETE AA FROM Trn_Activity_Attempt AA INNER JOIN #TempActivity TA ON AA.Patient_Activity_ID = TA.PatientActivityID 	DELETE A FROM Trn_Patient_Activity A INNER JOIN #TempActivity TA ON A.Patient_Activity_ID = TA.PatientActivityID 	 	DELETE PA FROM Trn_Patient_Allergies PA INNER JOIN #TempPatient T ON PA.Patient_ID=T.PatientID 	DELETE PA FROM Trn_Patient_Appointment PA INNER JOIN #TempPatient T ON PA.Patient_ID=T.PatientID 	DELETE PA FROM Trn_Patient_Attachment PA INNER JOIN #TempPatient T ON PA.PatientId=T.PatientID 	DELETE PB FROM Trn_Patient_Barrier_Assessment PB INNER JOIN #TempPatient T ON PB.PatientId=T.PatientID 	DELETE PC FROM Trn_Patient_Conversion PC INNER JOIN #TempPatient T ON PC.PatientId=T.PatientID 	DELETE PD FROM Trn_Patient_Discharge PD INNER JOIN #TempPatient T ON PD.Patient_ID=T.PatientID 	 	DELETE CI FROM Trn_Clinical_Intervention CI INNER JOIN #TempPatient T ON CI.Patient_ID=T.PatientID 	DELETE PMD FROM Trn_Patient_Med_Dosage PMD INNER JOIN #TempPatient T ON PMD.Patient_ID=T.PatientID 	 	DELETE PN FROM Trn_Patient_Notes PN INNER JOIN #TempPatient T ON PN.Patient_ID=T.PatientID 	DELETE PC FROM Trn_Patient_PCP PC INNER JOIN #TempPatient T ON PC.PatientId=T.PatientID 	DELETE PP FROM Trn_Patient_Pharmcy PP INNER JOIN #TempPatient T ON PP.Patient_ID=T.PatientID 	DELETE PP FROM Trn_Patient_Prescriber PP INNER JOIN #TempPatient T ON PP.Patient_ID=T.PatientID 	DELETE PQA FROM Trn_PatientQuestionAnswers PQA INNER JOIN #TempPatient T ON PQA.PatientID=T.PatientID 	 	DELETE EA FROM Trn_Enrollment_Attempt EA INNER JOIN Trn_Patient_Enrollment E ON EA.EnrollmentId = E.Patient_Enroll_ID 	INNER JOIN #TempPatient T ON E.Patient_ID=T.PatientID  	DELETE E FROM Trn_Patient_Enrollment E INNER JOIN #TempPatient T ON E.Patient_ID=T.PatientID 	 	DELETE P FROM Mst_Patient P INNER JOIN #TempPatient T ON P.Patient_ID=T.PatientID 	 	SELECT * FROM #TempPatient 	--DROP TABLE #TempPatient END  -- EXEC USP_BulkDataPullRequest 'C:\Working\Salutem\Docs\7July2022- DataPull-Update\CSV-MRNs to be Deleted from Salutem 06.28.22.csv' --Exec USP_DeletePayerPatient  