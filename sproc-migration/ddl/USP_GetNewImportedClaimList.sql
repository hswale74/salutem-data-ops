 Create procedure USP_GetNewImportedClaimList AS BEGIN 	SELECT DISTINCT  		CI.NABP_NCPDP_NUMBER, 		CI.Pharmacy_NPI, 		CI.MBI, 		CI.rx_number, 		CI.service_date, 		NDC.NDC, 		CI.quantity, 		CI.days_supply, 		CI.REFILL_DUE_DATE, 		CI.MEMBER_COPAYMENT, 		CI.CLIENT_COST, 		CI.FORMULARY_INDICATOR, 		CI.Prescriber_NPI, 		CI.Prescriber_last_name, 		CI.Prescriber_first_name, 		CI.PRESCRIBER_ADDRESS1, 		CI.PRESCRIBER_ADDRESS2, 		CI.PRESCRIBER_CITY, 		CI.PRESCRIBER_STATE, 		CI.PRESCRIBER_ZIP_CODE, 		CI.Prescriber_phone, 		CI.DAW_CODE, 		CI.PART_D_DRUG_INDICATOR, 		P.Patient_ID, 		NDC.Med_ID, 		NDC.Strength_ID  	FROM Salutem_Temp.DBO.Claim_Import CI  	INNER JOIN Mst_Patient P ON CI.MBI=P.Patient_MRN AND P.Patient_Status=1 	-- Below join required to get med id and strength id 	-- Getting first 9 digit ndc only as per requirement 	-- if it is not a 9 digit then adding 0 at left position to make it 9 digit. 	INNER JOIN Mst_MedNDC NDC ON NDC.NDC = SUBSTRING((REPLICATE('0',11-LEN(SUBSTRING(CI.ndc,1,11))) + SUBSTRING(CI.ndc,1,11)),1,9)  	LEFT JOIN Trn_Patient_Med_Dosage PMD ON P.Patient_ID = PMD.Patient_ID AND CI.service_date=PMD.ServiceDate AND CI.rx_number=PMD.RxNumber  		AND PMD.Med_ID = NDC.Med_ID AND ISNULL(PMD.Med_Strength_ID,0) = ISNULL(NDC.Strength_ID,0) 	WHERE PMD.Patient_Dosage_ID IS NULL  	ORDER BY P.Patient_ID,REFILL_DUE_DATE,NDC,rx_number,service_date END