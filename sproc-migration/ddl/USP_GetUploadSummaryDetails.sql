 Create procedure USP_GetUploadSummaryDetails ( 	@AccountId INT, 	@orderBy nvarchar(50) = 'UploadDate',  	@orderDir varchar(4) = 'desc',  	@StartFrom int = 0,  	@PageSize int = 999999 )AS BEGIN 	With UploadSummaryResult AS ( 		SELECT UPL.ID, 			UploadType, 			UploadDate, 			UPL.UploadedBy, 			U.User_First_Name + ' ' + U.User_Last_Name AS UploadedByName, 			UploadStatus, 			MemberCount, 			ClaimCount, 			PDCActivityCount, 			ErrorText, 			UpdatedRecordCount, 			NewEnrollmentQueuecount 		FROM UploadSummary UPL LEFT JOIN Mst_User U ON UPL.UploadedBy=U.User_ID 		WHERE UPL.ID>0 AND UPL.AccountID = @AccountId 	),  	OrderByResult AS (SELECT *, 			ROW_NUMBER() over ( 			order BY UploadDate DESC, case when @orderBy = 'UploadType' and @orderDir = 'asc' then UploadType end, 								case when @orderBy = 'UploadType' and @orderDir = 'desc' then UploadType end desc, 								case when @orderBy = 'UploadedBy' and @orderDir = 'asc' then UploadedBy end, 								case when @orderBy = 'UploadedBy' and @orderDir = 'desc' then UploadedBy end desc, 								case when @orderBy = 'UploadStatus' and @orderDir = 'asc' then UploadStatus end, 								case when @orderBy = 'UploadStatus' and @orderDir = 'desc' then UploadStatus end desc, 								case when @orderBy = 'MemberCount' and @orderDir = 'asc' then MemberCount end, 								case when @orderBy = 'MemberCount' and @orderDir = 'desc' then MemberCount end desc,  								case when @orderBy = 'ClaimCount' and @orderDir = 'asc' then ClaimCount end, 								case when @orderBy = 'ClaimCount' and @orderDir = 'desc' then ClaimCount end desc, 								case when @orderBy = 'PDCActivityCount' and @orderDir = 'asc' then PDCActivityCount end, 								case when @orderBy = 'PDCActivityCount' and @orderDir = 'desc' then PDCActivityCount end desc, 								case when @orderBy = 'ErrorText' and @orderDir = 'asc' then ErrorText end, 								case when @orderBy = 'ErrorText' and @orderDir = 'desc' then ErrorText end desc 								 			) AS RowNumber FROM UploadSummaryResult  	)   	SELECT *, (Select Count(ID) FROM UploadSummaryResult) TotalRows   	FROM OrderByResult  	WHERE OrderByResult.RowNumber BETWEEN (@StartFrom + 1) AND (@StartFrom  + @pageSize) END -- EXEC USP_GetUploadSummaryDetails 