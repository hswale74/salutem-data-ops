 CREATE PROCEDURE [dbo].[USP_GetFirstBillingActivityIDByMonthOfService] ( 	@PatientID INT, 	@MonthOfService DATETIME  ) AS BEGIN 	--Here returning billing activity id for the patient and for the given month. 	--For billing need to consider IA,ClinicalCareScreening, PN OR GN activities only and that is priority by Sequence Number. 	--Sequence number is important here because IA is the high priority one and after that progress note and after that Group note. 	SELECT TOP 1  PA.Patient_Activity_ID, PA.Activity_ID, MA.ActivityType, PA.Activity_Assigned_To, PA.AssessmentID 	FROM Trn_Patient_Activity PA  	INNER JOIN Mst_Activity MA ON PA.Activity_ID = MA.Activity_ID  		AND MA.ActivityType IN ('InitialAssessment', 'ProgressNote', 'GroupNote','ClinicalCareScreening')  		AND PA.Activity_Start_Status = 3 and PA.IsSubmited = 1 -- need to get here only completed and submitted activitites 		AND PA.DateOfService = @MonthOfService 		AND PA.Activity_Status = 1 	WHERE PA.Patient_ID = @PatientID ORDER BY MA.SequenceNumber, PA.Patient_Activity_ID END  --EXEC USP_GetFirstBillingActivityIDByMonthOfService 25804, '31July2022'