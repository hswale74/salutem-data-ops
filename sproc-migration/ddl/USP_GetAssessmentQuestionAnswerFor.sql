 Create PROCEDURE [dbo].[USP_GetAssessmentQuestionAnswerFor] 	@PatientID INT, 	@QuestionFor INT, 	@AssessmentID INT = 0, 	@QuestionSubType INT = 0, 	@AccountType INT = 0, 	@PatientActivityID int = 0 AS BEGIN 	IF @PatientActivityID = 0  	BEGIN 		SELECT QM.QuestionID,QuestionType,QuestionText,QuestionFor,QuestonSubType,QM.QuestionLinkID,QM.ClassInfo,QM.QuestionDescription, 		QO.ID OptionID,QO.OptionsFor,QO.OptionText,QO.OptionValue,QO.HasChildQuestion,QO.ChildQuestionLinkID,QO.AdditionalInfo,QO.AccountTypeId, 		QO.HasQuestionLink, QO.LinkQuestionIds,QO.HasTypeQuantityFrequency,		 		PQA.ID, 		COALESCE(PQA.PatientID, @PatientID) PatientID, 		PQA.AnswerText, 		(CASE WHEN QM.QuestionType = 6 OR QM.QuestionType = 7 OR QM.QuestionType = 8 OR QM.QuestionType = 9 -- When Question type is ShortAnswer or LongAnswer or NumberText or DateText then it should be display text as it is saved in answer table. 			THEN PQA.AnswerText  			ELSE (SELECT OptionText FROM Mst_QuestionOptions MQO WHERE MQO.OptionValue = PQA.AnswerText AND MQO.QuestionLinkID = QM.QuestionLinkID)  			END) DisplayAnswerText, 		PQA.AssessmentID, 		PQA.TypeText, 		PQA.QuantityText, 		PQA.FrequencyText, 		PQA.OtherComment, 		PQA.IsDeleted, 		QM.SequenceNumber 	FROM Mst_Questions QM  	INNER JOIN Mst_QuestionOptions QO ON QM.QuestionLinkID=QO.QuestionLinkID  	LEFT JOIN Trn_PatientQuestionAnswers PQA ON QM.QuestionID = PQA.QuestionID AND PQA.PatientID = @PatientID AND PQA.AssessmentID = @AssessmentID and PQA.IsDeleted=0 	WHERE QuestionFor = @QuestionFor AND (@AccountType = 0 OR QM.AccountTypeId = @AccountType) 	END 	ELSE 	BEGIN 		SELECT QM.QuestionID,QuestionType,QuestionText,QuestionFor,QuestonSubType,QM.QuestionLinkID,QM.ClassInfo,QM.QuestionDescription, 		QO.ID OptionID,QO.OptionsFor,QO.OptionText,QO.OptionValue,QO.HasChildQuestion,QO.ChildQuestionLinkID,QO.AdditionalInfo,QO.AccountTypeId, 		QO.HasQuestionLink, QO.LinkQuestionIds,QO.HasTypeQuantityFrequency,		 		PQA.ID, 		COALESCE(PQA.PatientID, @PatientID) PatientID, 		PQA.AnswerText, 		(CASE WHEN QM.QuestionType = 6 OR QM.QuestionType = 7 OR QM.QuestionType = 8 OR QM.QuestionType = 9 -- When Question type is ShortAnswer or LongAnswer or NumberText or DateText then it should be display text as it is saved in answer table. 			THEN PQA.AnswerText  			ELSE (SELECT OptionText FROM Mst_QuestionOptions MQO WHERE MQO.OptionValue = PQA.AnswerText AND MQO.QuestionLinkID = QM.QuestionLinkID)  			END) DisplayAnswerText, 		PQA.AssessmentID, 		PQA.TypeText, 		PQA.QuantityText, 		PQA.FrequencyText, 		PQA.OtherComment, 		PQA.IsDeleted, 		QM.SequenceNumber 	FROM Mst_Questions QM  	INNER JOIN Mst_QuestionOptions QO ON QM.QuestionLinkID=QO.QuestionLinkID  	LEFT JOIN Trn_PatientQuestionAnswersLog PQA ON QM.QuestionID = PQA.QuestionID AND PQA.PatientID = @PatientID AND PQA.AssessmentID = @AssessmentID and PQA.IsDeleted=0 AND PQA.PatientActivityID = @PatientActivityID 	WHERE QuestionFor = @QuestionFor AND (@AccountType = 0 OR QM.AccountTypeId = @AccountType) 	END END  -- EXEC USP_GetAssessmentQuestionAnswerFor 19200, 4