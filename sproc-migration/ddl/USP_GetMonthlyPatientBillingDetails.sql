 CREATE procedure USP_GetMonthlyPatientBillingDetails ( 	@AccountID INT, 	@fromDate DATETIME, 	@toDate DATETIME ) AS BEGIN 	SET NOCOUNT ON;  	SELECT  		BD.ID, 		P.Patient_ID, 		P.Patient_First_Name +' ' + P.Patient_Last_Name AS PatientFullName, 		P.Patient_DOB, 		BD.PatientActivityID, 		BD.ActivityType AS Activity_Name, 		BD.MonthOfService, 		BD.DateOfService, 		BD.SpentDuration, 		U.User_First_Name + ' ' + U.User_Last_Name AS AssignedUser, 		TBP.BillingCPTCode, 		TBP.AddOnCPTCode, 		TBP.PracticeName, 		TBP.SecondAddOnCode, 		EN.Discription AS NoteTypeName, 		P.PatientStatusId, 		MP.StatusName PatientStatusName, 		PA.EncounterDate, 		PA.EncounterStartTime, 		PA.EncounterEndTime, 		PR.BillingType, 		PR.BillingTime, 		PR.BillingTimeFees, 		TBP.PracticeBillingType, 		TBP.PracticeBillingTime, 		TBP.PracticeBillingFee, 		TBP.TotalCharges 	FROM TrnBillingProfile TBP 	INNER JOIN TrnPatientBillingDetail BD ON TBP.PatientID = BD.PatientID AND TBP.MonthOfService = BD.MonthOfService AND BD.IsDeleted =0 	INNER JOIN Mst_Patient P ON BD.PatientID = p.Patient_ID AND P.Account_ID = @AccountID 		AND (P.TypeOfReferral <> 1 OR P.TypeOfReferral IS NULL) -- Direct bill referral type patients should not listed in report as per requirement mentioned in ticket #5313 	INNER JOIN Mst_User U ON BD.ActivityAssignedTo = U.User_ID 	LEFT JOIN TrnPatientAssessmentLog PA ON BD.PatientActivityID = PA.PatientActivityID  	LEFT JOIN Mst_Enum EN ON PA.NoteType = EN.ID AND EN.EnumType='GenericNoteType'  	LEFT JOIN MstPatientStatuses MP ON MP.ID = P.PatientStatusId 	LEFT JOIN Mst_Practice PR ON TBP.PracticeName = PR.PracticeName 	WHERE BD.MonthOfService >= @fromDate and BD.MonthOfService <= @toDate 	ORDER BY PatientFullName, Patient_ID, BD.DateOfService END  