 Create procedure [dbo].[USP_GetReferralLogDetail] ( 	@ReferralID int ) AS BEGIN 	SET NOCOUNT ON; 	SELECT RPL.Referral_ID, 				RPL.Patient_ID, 				RPL.ReferralType, 				enum.Discription AS IncomingType, 				RPL.ReferralDate,  				RPL.ReferralTime, 				PRAC.PracticeName, 				RPL.AssignTo, 				usr.User_First_Name + ' ' + usr.User_Last_Name AS AssignUserName, 				RPL.ReferralStatus, 				enums.Discription AS ReferralStatusName, 				RPL.PrimaryContactNumber, 				RPL.FaxNumber, 				RPL.PrimaryContactEmail, 				--From Here added extra columns 				RPL.Salutation, 				RPL.PatientFirstName, 				RPL.PatientMiddleName, 				RPL.PatientLastName, 				RPL.DOB, 				RPL.Gender, 				RPL.PatientPractice, 				RPL.PrimaryPhysician, 				phy.PhysicianName, -- 				RPL.ReasonForReferralId, 				dia.ICD10Code + ' - ' + dia.Diagnosis_Name AS ReasonForReferralName, 				RPL.ReferringProviderId, 				MRP.PracticeName as ReferringProviderName, 				RPL.PrimaryContactRelationID, 				RPL.PrimaryContactName, 				RPL.PrimaryContactAdd1, 				RPL.PrimaryContactAdd2, 				RPL.PrimaryContactCity, 				RPL.PrimaryContactState, 				RPL.PrimaryContactZip, 				RPL.PrimaryContactIsMobilePreference, 				RPL.PrimaryContactIsEmailPreference, 				RPL.PrimaryContactIsSMSPreference, 				RPL.SecondaryContactRelationID, 				RPL.SecondaryContactName, 				RPL.SecondaryContactNumber, 				RPL.SecondaryContactEmail, 				RPL.SecondaryContactAdd1, 				RPL.SecondaryContactAdd2, 				RPL.SecondaryContactCity, 				RPL.SecondaryContactState, 				RPL.SecondaryContactZip, 				RPL.SecondaryContactIsMobilePreference, 				RPL.SecondaryContactIsEmailPreference, 				RPL.SecondaryContactIsSMSPreference, 				RPL.PrimaryInsurance, 				insuP.Insurance AS PrimaryInsuranceName, 				RPL.SecondaryInsurance, 				insuS.Insurance AS SecondaryInsuranceName, 				RPL.TertiaryInsurance, 				insuT.Insurance AS TertiaryInsuranceName, 				RPL.GroupAssessmentComments, 				RPL.PrimaryInsuranceIDNumber, 				RPL.PrimaryInsuranceGroupNumber, 				RPL.PrimaryInsuranceStartDate, 				RPL.PrimaryInsuranceEndDate, 				RPL.SecondaryInsuranceIDNumber, 				RPL.SecondaryInsuranceGroupNumber, 				RPL.SecondaryInsuranceStartDate, 				RPL.SecondaryInsuranceEndDate, 				RPL.TertiaryInsuranceIDNumber, 				RPL.TertiaryInsuranceGroupNumber, 				RPL.TertiaryInsuranceStartDate, 				RPL.TertiaryInsuranceEndDate, 				RPL.Note, 				RPL.IsPatientRegistered, 				RPL.IsSUD, 				RPL.IsFlagThisPatient, 				RPL.AreYouEligible, 				RPL.NotEligibleReason, 				RPL.NotEligibleReasonNote, 				insuP.StateID as PrimaryStateId, 				insuS.StateID as SecondaryStateId, 				insuT.StateID as TertiaryStateId 		FROM ReferralPatientLog RPL 		LEFT JOIN Mst_Enum enum ON RPL.ReferralType = enum.EnumValue AND EnumType = 'ReferralIncomingType' 		LEFT JOIN Mst_Practice PRAC ON RPL.PatientPractice = PRAC.ID 		LEFT JOIN Mst_User usr ON RPL.AssignTo = usr.User_ID 		LEFT JOIN Mst_Enum enums ON RPL.ReferralStatus = enums.EnumValue AND enums.EnumType = 'ReferralStatus' 		LEFT JOIN Mst_Physician phy ON RPL.PrimaryPhysician = phy.ID 		LEFT JOIN Mst_Practice MRP ON RPL.ReferringProviderId = MRP.ID 		LEFT JOIN Mst_Diagnosis dia ON RPL.ReasonForReferralId = dia.Diagnosis_ID 		LEFT JOIN Mst_Insurance insuP ON RPL.PrimaryInsurance = insuP.ID 		LEFT JOIN Mst_Insurance insuS ON RPL.SecondaryInsurance = insuS.ID 		LEFT JOIN Mst_Insurance insuT ON RPL.TertiaryInsurance = insuT.ID 		WHERE RPL.Referral_ID = @ReferralID END  /*exec USP_GetReferralLogDetail 6*/