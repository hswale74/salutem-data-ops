-- EXEC USP_GetPatientSocialHistoryDetails 2415, 0
create procedure dbo.usp_getpatientsocialhistorydetails
    (@PatientID int, @AssessmentID int, @PatientActivityID int = 0)
as begin
    if @PatientActivityID = 0
        begin
            select
                id,
                patientid,
                assessmentid,
                highesteducationid,
                otherhighesteducation,
                livingsalutationid,
                otherlivingsalutation,
                currentresidentsid,
                genderidentity,
                sexualorientation,
                maritalstatusid,
                romanticrelationship,
                otherromanticrelationship,
                haschildren,
                noofchildern,
                childrengenderid,
                childrenage,
                motherlifestatusid,
                motherrelationshipid,
                fatherlifestatusid,
                fatherrelationshipid,
                hasotherparentalfigure,
                otherparentallifestatusid,
                otherparentalrelationshipid,
                hassiblings,
                developmentupbringing,
                modeofbirth,
                haspets,
                petsdetails,
                otherpetsdetails,
                socialsupportnetwork,
                othersocialsupportnetwork,
                hasreligiousaffiliation,
                hashobbies,
                otherhobbies,
                hasselfcarebarrier,
                otherselfcarebarrier,
                hasbasicneedsmet,
                otherbasicneedsmet,
                haslegalhistory,
                otherlegalhistory,
                hascurrentlegalcharges,
                othercurrentlegalcharges,
                isdeleted,
                maritalstatuscomment,
                romanticrelationshipcomment,
                religiousaffiliationcomment,
                otherparentalfigurecomment,
                othergenderidentity,
                othersexualorientation
            from trn_socialhistory
            where patientid = @PatientID and assessmentid = @AssessmentID
        end
    else
        begin
            select
                id,
                patientid,
                assessmentid,
                highesteducationid,
                otherhighesteducation,
                livingsalutationid,
                otherlivingsalutation,
                currentresidentsid,
                genderidentity,
                sexualorientation,
                maritalstatusid,
                romanticrelationship,
                otherromanticrelationship,
                haschildren,
                noofchildern,
                childrengenderid,
                childrenage,
                motherlifestatusid,
                motherrelationshipid,
                fatherlifestatusid,
                fatherrelationshipid,
                hasotherparentalfigure,
                otherparentallifestatusid,
                otherparentalrelationshipid,
                hassiblings,
                developmentupbringing,
                modeofbirth,
                haspets,
                petsdetails,
                otherpetsdetails,
                socialsupportnetwork,
                othersocialsupportnetwork,
                hasreligiousaffiliation,
                hashobbies,
                otherhobbies,
                hasselfcarebarrier,
                otherselfcarebarrier,
                hasbasicneedsmet,
                otherbasicneedsmet,
                haslegalhistory,
                otherlegalhistory,
                hascurrentlegalcharges,
                othercurrentlegalcharges,
                isdeleted,
                maritalstatuscomment,
                romanticrelationshipcomment,
                religiousaffiliationcomment,
                otherparentalfigurecomment,
                othergenderidentity,
                othersexualorientation
            from trn_socialhistorylog
            where
                patientid = @PatientID
                and patientactivityid = @PatientActivityID
        end
end
